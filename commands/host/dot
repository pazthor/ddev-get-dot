#!/bin/bash
set -eo pipefail

## #ddev-generated
## Description: executes a script from tools/scripts/laravel
## Usage: dot
## Example: ddev dot
## ExecRaw: true

# Configuration


readonly SCRIPT_DIR="/var/www/html/tools/scripts/laravel"

# 1) Grab basenames via ddev exec
get_script_names() {
  ddev exec "find '$SCRIPT_DIR' -type f -printf '%f\n'"
}

# 2) fzf + preview + run via ddev exec
run_script_selector() {
  get_script_names |
    fzf \
      --preview="ddev exec bash -c 'cat \"$SCRIPT_DIR/{}\"'" \
      --preview-window="right:60%" \
      --header="Select a script to execute" \
      --prompt="Script > " \
      --pointer=">" \
      --marker="*" \
      --bind="ctrl-space:toggle-preview" |
    xargs -r -I {} ddev exec "$SCRIPT_DIR/{}"
}

run_script_selector


