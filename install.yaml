# install.yaml for pazthor/ddev-get-dot
# https://ddev.readthedocs.io/en/stable/users/extend/additional-services/#sections-and-features-of-ddev-get-add-on-install

name: pazthor/ddev-get-dot

description: "Installs the 'dot' command and ensures fzf is present via a post-start hook"

# Files to copy into the project's .ddev directory.
# This simple list format is required for CI tools that can't parse DDEV's
# advanced source/target/merge syntax.
project_files:
  - commands/web/dot
  - config.ddev-get-dot.yml

# Files to copy into the global .ddev directory (not used here)
global_files: []

ddev_version_constraint: ""

dependencies: []

# Actions to run after the add-on is installed (in .ddev directory)
post_install_actions:
  # Merge the config file into the main .ddev/config.yaml
  - "ddev config --yaml-merge .ddev/config.ddev-get-dot.yml"
  # Remove the now-unnecessary addon config file
  - "rm .ddev/config.ddev-get-dot.yml"
  # Ensure the 'dot' script is executable
  - "chmod +x .ddev/commands/web/dot"

# Actions to run when the add-on is removed
removal_actions:
  # Remove the 'dot' command if it was unmodified
  - "rm -f .ddev/commands/web/dot"